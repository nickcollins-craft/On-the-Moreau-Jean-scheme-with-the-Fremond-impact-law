# On the Moreau–Jean scheme with the Frémond impact law: energy conservation and dissipation properties for elastodynamics with contact, impact and friction
This repository stores the codes associated with the paper "On the Moreau–Jean scheme with the Frémond impact law: energy conservation and dissipation properties for elastodynamics with contact, impact and friction", by V. Acary and N.A. Collins-Craft, available on HAL: [⟨hal-04230941⟩](https://hal.science/hal-04230941)
 
The codes are also available on [Zenodo](https://doi.org/10.5281/zenodo.10949879).
 
In order to run the codes, the user first requires a working installation of Python 3 (the codes were run on Python 3.12.1). We strongly recommend using a package manager such as [Anaconda](https://www.anaconda.com/download) or [Mamba](https://mamba.readthedocs.io/en/latest/installation/mamba-installation.html) to manage the installation.
Then, the user must install [meshio](https://github.com/nschloe/meshio) (the codes were run on meshio 5.3.4).
Separately, the user must also install [Gmsh](https://gmsh.info/) (the codes were run on Gmsh 4.11.1).
Finally, the user must also install [Siconos](https://nonsmooth.gricad-pages.univ-grenoble-alpes.fr/siconos/) (the codes were run on Siconos 4.5.0).
 
Then, the mesh file for the sliding block can be generated by typing
```
gmsh sliding_block_mesh.geo -1 -2
```
Next, after activating whatever Python environment that Siconos has been coupled to (if it is coupled to the base, this step can be skipped) by typing
```
conda activate name_of_your_environment
```
or similar (depending on your specific Python environment and package manager). Finally, the path to save the simulation data to, and the path to save the figures to should be set in path_file.py. Then, main.py can be run by typing 
```
siconos main.py
```
and pressing enter while in the working directory. This will run the rod, rocking block and sliding block codes for both the Moreau–Jean and Moreau–Jean–Frémond methods. The sliding block code will take some time to complete. The simulation codes are completed by the rockfall impact code, which is available [here](https://archive.softwareheritage.org/swh:1:cnt:ade5eb54939407f058dbaaec28ff285b5e71ba86;origin=https://gricad-gitlab.univ-grenoble-alpes.fr/nonsmooth/siconos-tutorials;visit=swh:1:snp:a2682a0bb31f68fd424b93a489b7b171cbeb0340;anchor=swh:1:rev:a04ed23ceb61f4d4024ff75fe45aff7c65acbcdb;path=/examples/mechanics/Masonry/RockProtectionWall/rock_protection_wall.py), and which can be quite time-consuming to run (on the order of three hours for each simulation). All other codes in this repository can be run by typing 
```
python3 <name_of_code.py>
```
and pressing enter while in the working directory, and are fast other than plot_rockfall_wall.py, which may take several minutes to return a figure.
 
Users of this software should cite the associated paper, and also each software listed above where appropriate.
 
One of the codes ("block_mesh_plot.py") also requires images that are included in the related [Zenodo repository](https://doi.org/10.5281/zenodo.10949808) containing the output data, but are assumed to be present in the folder specified by data_folder in path_file.py.

This repository also contains the Gmsh mesh file used to run the sliding block simulation, so if Gmsh is not installed, it should in principle still be possible to run the simulation, if not make any modifications to the geometry. However meshio is strictly required in order to read in the mesh file.
 
Contact: vincent[dot]acary[at]inria[dot]fr or nicholas[dot]collins-craft[at]inria[dot]fr

This software copyright &copy; Inria 2024 and is provided under the Apache 2.0 licence.
